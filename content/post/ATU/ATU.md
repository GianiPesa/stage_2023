---
title: "PowerShell, automatiser l’administration Windows"
draft: false
tags: ['Windows','powershell']
---

**Durée de la formation :** 3 jours (21 heures)

**Prix :** 1950 € H.T.

**Objectifs principaux :**  
À l’issue de la formation, le participant sera en mesure de :
* Ecrire des scripts sous Windows avec PowerShell
* Gérer les utilisateurs avec des scripts PowerShell
* Automatiser les tâches d'administration sous Windows avec PowerShell
* Formater les messages de sortie
* Utiliser les fonctionnalités de traitement en arrière-plan et d'administration à distance

 **Prérequis :** Bonnes connaissances des systèmes d'exploitation Windows. Connaissance d'un langage de script ou de programmation souhaitable.
Vérifiez que vous avez les prérequis nécessaires pour profiter pleinement de cette formation en faisant  [ce test](https://www.orsys.fr/qcm/?stagecd=ATU&languecd=fr).

## Programme de la formation :
{{< expandable label="1 - Les bases du langage :" level="2" >}}
* Le lien entre PowerShell et .NET.
* Principe, fonctionnalité, utilisation des commandes et cmdlets.
* Les pipelines : comportement des flux et leur paramétrage. Simplification du code, le pipelinevariable.
* Les filtres where-objects, les boucles foreach.
* Les variables, les types d'opérateurs.
* Windows ISE : environnement pour scripter.
* **Travaux pratiques :** Utilisation de différentes cmdlets, utilisation du pipe, du pipelinevariable. Utilisation des premières commandes. Utilisation des filtres.
{{< /expandable >}}
{{< expandable label="2 - Les types et opérateurs :" level="2" >}}
* Le système de typage, règles de conversion.
* Les variables, définition, portée.
* Les types de base.
* Les expressions régulières. Qualificateur.
* Opérateurs (arithmétique, assignation, logique, chaîne, redirection...).
* Les comparateurs et les collections.
* **Travaux pratiques :** Utiliser des variables, opérateurs et expressions régulières.
{{< /expandable >}}
{{< expandable label="3 - Les structures de contrôle et les fonctions :" level="2" >}}
* Structures de contrôle utilisant des cmdlets.
* Structures conditionnelles.
* Boucle for. Boucle while. Boucle foreach.
* Structure d'aiguillage (switch).
* Fonctions, modificateurs d'étendue.
* Phases d'exécution d'une fonction.
* Utilisation des fonctions dans un pipeline.
* Passage d'arguments à un script.
* **Travaux pratiques :** Mise en œuvre des structures de contrôle. Utilisation et paramétrage de fonctions.
{{< /expandable >}}
{{< expandable label="4 - Utilisation des cmdlettes et des modules :" level="2" >}}
* Gestion des archives (compress-archive, expand-archive).
* Les cmdlettes Web (invoke-webrequest, invoke-restmethod).
* Les cmdlettes pour gérer vos serveurs et postes de travail (add-computer, restart-computer).
* Les cmdlettes de gestion réseaux (new-net*, get-net*, get-bgprouter...).
* Les cmdlettes d'administration (get-event, start-process....).
* La gestion des fichiers (get-content, tee-object, import-csv, convertto-html et les feuilles de style).
* **Travaux pratiques :** Récupération d'un flux RSS sur Internet. Création d'une page Web avec utilisation d'une feuille de style, d'un script pour géolocaliser les adresses IP connectées sur les postes. Modification des adresses IP à distance, intégration d'ordinateur dans un domaine. Décompression de zip à distance.
{{< /expandable >}}
{{< expandable label="5 - Utilisation des objets CIM :" level="2" >}}
* Le modèle de données CIM (Common Information Model). CIM et WMI.
* Nouvelle cmdlet pour gérer le WMi (get-cimstance, new-cimsession...).
* Différence entre get-wmiobject et get-ciminstance.
* Listage des classes WMI, l'aide complète.
* Utilisation des méthodes et propriétés WMI (partages d'un poste, test de présence de machines sur le réseau...).
* **Travaux pratiques :** Retrouver les partages d'un poste. Supprimer des applications à distances, modifier une passerelle à distance. Récupérer des informations.
{{< /expandable >}}
{{< expandable label="6 - Utilisation de .NET et COM :" level="2" >}}
* Utilisation des bibliothèques d'objets pour manipuler les composants du système.
* Utilisation de classes du .NET (ping, udp, credential...).
* Les classes system.
* PowerShell et l'interface graphique : présentation XAML.
* **Travaux pratiques :** Création d'un formulaire en XAML. Création d'un script d'authentification sécurisé pour se connecter à des serveurs, script wake on lan.
{{< /expandable >}}
{{< expandable label="7 - Gestion des modules PowerShell, des packages :" level="2" >}}
* Fonctionnement d'un module. Lister les modules.
* Le module DHCP, DNS, hyper-V.
* Le module Active Directory.
* Les commandes : trouver, installer des modules (find-module, install-module...).
* Gestion des packages.
* **Travaux pratiques :** Création d'un utilisateur dans l'Active Directory, requête d'objets dans l'Active Directory, installation d'un module chargé sur internet, paramétrage.
{{< /expandable >}}
{{< expandable label="8 - Les objets com :" level="2" >}}
* Lister les objets com disponibles.
* Nouvelles performances des objets com.
* Création, modification d'un classeur Excel.
* Ouvrir un fichier PowerPoint, Word.
* **Travaux pratiques :** Création d'un classeur Excel, récupération des données serveurs (espace disque, IP, process, applications...).
{{< /expandable >}}
{{< expandable label="9 - Les meilleures cmdlettes et astuces PowerShell :" level="2" >}}
* les commandes : get-random, get-process, get-service.
* Transformer du texte en objet (ConvertFrom-String).
* La commande Psedit.
* Création de liens symbolique (new-item).
* Les commandes de base get-filehash, get-disk, get-hotfix.
* Les commandes et variables : new-guid, new-smbshare, new-timespan.
* **Travaux pratiques :** Création d'un générateur de mot de passe. Contrôle d'intégrité d'un fichier, permission NTFS. Génération d'un compteur temps, création de partage.

{{< /expandable >}}


##### [Lien vers la formation](https://www.orsys.fr/formation/ATU)